\documentclass{standalone}
\usepackage[dvipsnames]{xcolor}
\usepackage{listings}
\input{../Course-on-Software-Product-Lines/slides/template/colorscheme}

\lstdefinestyle{javawithpp}{
	language=Java,
	tabsize=2,
	breaklines=true,
	basicstyle=\footnotesize\ttfamily,
	keywordstyle=\color{blue}\ttfamily,
	stringstyle=\color{red}\ttfamily,
	commentstyle=\color{Purple}\ttfamily,
	showstringspaces=false,
	columns=fullflexible
}

\begin{document}
	\begin{lstlisting}[style=javawithpp]
		public class AccessHandler {
			UserSession session;
			
			public void handleLogin(String user, String password) {
				#ifdef SECURE_LOGIN
				if (!authenticate(user, password)) {
					throw new SecurityException("Login failed");
				}
				#endif
				
				#ifdef CACHING
				session = Cache.get(user);
				if (session == null) {
					session = new UserSession(user);
					Cache.put(user, session);
				}
				#endif
				
				#ifdef LOGGING
				Logger.log("User " + session.getUser() + " logged in at " + System.currentTimeMillis());
				#endif
			}
			
			#ifdef SECURE_LOGGIN
			private boolean authenticate(String user, String password) {
				return user.equals("admin") && password.equals("1234");
			}
			#endif
		}
	\end{lstlisting}
\end{document}
